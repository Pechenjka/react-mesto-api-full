(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n(1),c=n.n(o),i=n(23),r=n.n(i),s=n(11),u=(n(35),n(28)),l=n(4),d=n(3),p=Object(o.createContext)(),m=n(24),h=n(25),f=new(function(){function e(t){Object(m.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(h.a)(e,[{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"getInitialCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"setUserInfo",value:function(e){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"addNewCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"setUserAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e._id),{method:"".concat(t?"DELETE":"PUT"),headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430:".concat(e.status))})).then((function(e){return e}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-17",headers:{authorization:"fa53dc10-0bed-404e-84a8-68518d7f0629","Content-Type":"application/json"}}),j="https://auth.nomoreparties.co",b=function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))},_=n.p+"static/media/logo_header.c2821b38.svg",O=(n(36),function(e){var t=e.onSignOut,n=c.a.useState(!1),o=Object(l.a)(n,2),i=o[0],r=o[1];return Object(a.jsx)("div",{className:"burger-menu ".concat(i?"burger-menu_active":""),onClick:function(){!0===i&&r(!1)},children:Object(a.jsxs)("div",{className:"burger-menu__content",children:[Object(a.jsx)("button",{type:"button",className:"burger-menu__button ".concat(i?"burger-menu__button_active":"burger-menu__button_close"),onClick:function(){r(!i)}}),Object(a.jsxs)("ul",{className:"burger-menu__container ".concat(i&&"burger-menu__container_active"),children:[Object(a.jsx)("li",{className:"burger-menu__wrapper",children:Object(a.jsx)("p",{className:"burger-menu__email",children:localStorage.getItem("email")})}),Object(a.jsx)("li",{className:"burger-menu__wrapper",children:Object(a.jsx)("button",{className:"burger-menu__exitButton",onClick:t,children:"\u0412\u044b\u0439\u0442\u0438"})})]})]})})}),g=function(e){var t=e.handleSignOut;return!0===e.loggedIn&&Object(a.jsxs)("header",{className:"header",children:[Object(a.jsx)("img",{className:"header__logo",src:_,alt:"\u041b\u043e\u0433\u043e - \u0448\u0430\u043f\u043a\u0430 \u0441\u0430\u0439\u0442\u0430"}),Object(a.jsx)(O,{onSignOut:t})]})},x=function(e){var t=e.card,n=e.onCardClick,o=e.onCardLike,i=e.onConfirmDeleteCardClick,r=c.a.useContext(p),s=t.owner._id===r._id,u="card__delete ".concat(s?"card__delete_visible":""),l=t.likes.some((function(e){return e._id===r._id})),d="card__like-button ".concat(l?"card__like-button_active":"");return Object(a.jsxs)("li",{className:"card",children:[Object(a.jsx)("img",{src:t.link,alt:t.name,className:"card__image",onClick:function(){n(t)}}),Object(a.jsx)("button",{className:u,type:"button","aria-label":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0443",onClick:function(){i(t)}}),Object(a.jsx)("h3",{className:"card__title",children:t.name}),Object(a.jsxs)("div",{className:"card__like-container",children:[Object(a.jsx)("button",{className:d,type:"button","aria-label":"\u041f\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043b\u0430\u0439\u043a",onClick:function(){o(t)}}),Object(a.jsx)("span",{className:"card__like-count",children:t.likes.length})]})]})},v=function(e){var t=e.onEditAvatar,n=e.onEditProfile,o=e.onAddPlace,i=e.onConfirmDeleteCardClick,r=e.onCardClick,s=e.onCardLike,u=e.cards,l=c.a.useContext(p);return Object(a.jsxs)("main",{className:"content",children:[Object(a.jsxs)("section",{className:"profile",children:[Object(a.jsxs)("div",{className:"profile__author",children:[Object(a.jsx)("div",{className:"profile__edit-avatar",children:Object(a.jsx)("img",{alt:"\u0424\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044f \u0430\u0432\u0442\u043e\u0440\u0430",className:"profile__image-author",onClick:t,src:l.avatar})}),Object(a.jsxs)("div",{className:"profile__description-author",children:[Object(a.jsx)("h1",{className:"profile__title",children:l.name}),Object(a.jsx)("button",{className:"profile__edit-button",onClick:n,type:"button","aria-label":"\u041e\u0442\u043a\u0440\u044b\u0442\u0438\u0435 \u043e\u043a\u043d\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043f\u0440\u043e\u0444\u0438\u043b\u044f \u0430\u0432\u0442\u043e\u0440\u0430"}),Object(a.jsx)("p",{className:"profile__about-author",children:l.about})]})]}),Object(a.jsx)("button",{className:"profile__add-button",onClick:o,type:"button","aria-label":"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438"})]}),Object(a.jsx)("section",{className:"grid-cards",children:Object(a.jsx)("ul",{className:"cards",children:u.map((function(e){return Object(a.jsx)(x,{card:e,onCardClick:r,onCardLike:s,onConfirmDeleteCardClick:i},e._id)}))})})]})},C=function(e){return!0===e.loggedIn&&Object(a.jsx)("footer",{className:"footer",children:Object(a.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",(new Date).getFullYear()," Mesto Russia"]})})},k=function(e){var t=e.name,n=e.title,c=e.isOpen,i=e.onClose,r=e.children,s=e.submitButton,u=e.onSubmit,l=e.disabled,d=e.classes,p=e.isInfoTooltip,m=e.checkIcon,h=e.titleInfoTooltips;return Object(a.jsx)("div",{children:Object(a.jsx)("section",{className:"popup popup__".concat(t," ").concat(c?"popup_opened":""),onClick:i,children:Object(a.jsxs)("div",{className:"popup__container ",onClick:function(e){return e.stopPropagation()},children:[Object(a.jsx)("button",{className:"popup__close-button",type:"button","aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u043c\u043e\u0434\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u043a\u043d\u0430",onClick:i}),!0===p?Object(a.jsxs)(o.Fragment,{children:[Object(a.jsx)("img",{className:d.checkicon,src:m,alt:"\u043b\u043e\u0433\u043e"}),Object(a.jsx)("h3",{className:d.title,children:h})]}):Object(a.jsxs)(o.Fragment,{children:[Object(a.jsx)("h2",{className:"popup__title",children:n}),Object(a.jsxs)("form",{className:"popup__form popup__form_".concat(t),action:"#",name:"popupForm__".concat(t),onSubmit:u,noValidate:!0,children:[r,Object(a.jsx)("button",{type:"submit",className:"popup__submit-button ".concat(l?"popup__button_disabled":""),disabled:l,children:s})]})]})]})})})},N=n(15),y=n(12),S=function(){var e=c.a.useState({}),t=Object(l.a)(e,2),n=t[0],a=t[1],o=c.a.useState({}),i=Object(l.a)(o,2),r=i[0],s=i[1],u=c.a.useState({}),d=Object(l.a)(u,2),p=d[0],m=d[1],h=c.a.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a(e),s(t),m(n)}),[a,s,m]);return{values:n,setValues:a,errors:r,isValid:p,handleChange:function(e){var t=e.target,o=t.name,c=t.value;a(Object(y.a)(Object(y.a)({},n),{},Object(N.a)({},o,c))),s(Object(y.a)(Object(y.a)({},r),{},Object(N.a)({},o,t.validationMessage))),m(t.closest("form").checkValidity())},resetForm:h}},I=function(){return Object(a.jsx)("div",{className:"spinner__container",children:Object(a.jsx)("div",{className:"spinner__zenith"})})},L=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateUser,i=e.isLoading,r=S(),s=r.values,u=r.errors,l=r.isValid,d=r.handleChange,m=r.resetForm,h=c.a.useContext(p);return c.a.useEffect((function(){h&&m(h)}),[h,m]),Object(a.jsx)(k,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",submitButton:"".concat(i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o(s)},disabled:!l,children:i?Object(a.jsx)(I,{}):Object(a.jsxs)("fieldset",{className:"popup__form-input",children:[Object(a.jsx)("input",{className:"popup__input popup__form-author popup__form_author_name",id:"nameAuthor-input",type:"text",name:"name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",onChange:d,value:s.name||""}),Object(a.jsx)("span",{className:"popup__form-input-error ".concat(l?"":"popup__form-input-error_active"),id:"nameAuthor-input-error",children:u.name}),Object(a.jsx)("input",{className:"popup__input popup__form-author popup__form_author_about",id:"aboutAuthor-input",type:"text",name:"about",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",onChange:d,value:s.about||""}),Object(a.jsx)("span",{className:"popup__form-input-error ".concat(l?"":"popup__form-input-error_active"),id:"aboutAuthor-input-error",children:u.about})]})})},w=function(e){var t=e.isOpen,n=e.onClose,o=e.onUpdateAvatar,i=e.isLoading,r=S(),s=r.values,u=r.errors,l=r.isValid,d=r.handleChange,p=r.resetForm;return c.a.useEffect((function(){p()}),[t,p]),Object(a.jsx)(k,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"new-avatar",submitButton:"".concat(i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o(s)},disabled:!l,children:i?Object(a.jsx)(I,{}):Object(a.jsxs)("fieldset",{className:"popup__form-input",children:[Object(a.jsx)("input",{className:"popup__input  popup__form_edit-avatar",id:"avatarLink-input",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440\u043a\u0443",name:"avatar",required:!0,onChange:d,value:s.avatar||""}),Object(a.jsx)("span",{className:"popup__form-input-error ".concat(l?"":"popup__form-input-error_active"),id:"avatarLink-input-error",children:u.name})]})})},T=function(e){var t=e.isOpen,n=e.onClose,o=e.onAddPlace,i=e.isLoading,r=S(),s=r.values,u=r.errors,l=r.isValid,d=r.handleChange,p=r.resetForm;return c.a.useEffect((function(){p()}),[t,p]),Object(a.jsx)(k,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",submitButton:"".concat(i?"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435...":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o(s)},disabled:!l,children:i?Object(a.jsx)(I,{}):Object(a.jsxs)("fieldset",{className:"popup__form-input",children:[Object(a.jsx)("input",{className:"popup__input popup__form-author popup__form_card_name",id:"cardName-input",type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",required:!0,minLength:"2",maxLength:"30",onChange:d,value:s.name||""}),Object(a.jsx)("span",{className:"popup__form-input-error ".concat(l?"":"popup__form-input-error_active"),id:"cardName-input-error",children:u.name}),Object(a.jsx)("input",{className:"popup__input popup__form-author popup__form_card_link",id:"cardLink-input",type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",name:"link",required:!0,onChange:d,value:s.link||""}),Object(a.jsx)("span",{className:"popup__form-input-error ".concat(l?"":"popup__form-input-error_active"),id:"cardLink-input-error",children:u.link})]})})},E=function(e){var t=e.isOpen,n=e.onClose,o=e.onCardDelete,c=e.isLoading;return Object(a.jsx)(k,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitButton:"".concat(c?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430"),name:"delete-card",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o()},children:c?Object(a.jsx)(I,{}):""})},P=function(e){var t=e.selectedCard,n=e.onClose,o=e.isOpen;return Object(a.jsx)("section",{className:"popup popup__open-card ".concat(o?"popup_opened":""),onClick:n,children:Object(a.jsxs)("div",{className:"popup__container-open-card",onClick:function(e){return e.stopPropagation()},children:[Object(a.jsx)("button",{className:"popup__close-button popup__close-button_open-card",type:"button",onClick:n,"aria-label":"\u0417\u0430\u043a\u0440\u044b\u0442\u0438\u0435 \u043e\u043a\u043d\u0430 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438"}),Object(a.jsxs)("figure",{className:"popup__open-card-figure",children:[Object(a.jsx)("img",{src:t?t.link:"",alt:t?t.name:"",className:"popup__open-card-image"}),Object(a.jsx)("figcaption",{className:"popup__open-card-figcaption",children:t?t.name:""})]})]})})},U=(n(37),function(e){var t=e.errors,n=e.isValid,o=e.values,c=e.onChange,i=e.submitButton,r=e.title,u=e.linkNameAuthHeader,l=e.path,d=e.classLink,p=e.onSubmit,m=e.onClick,h=e.disabled,f=e.isLoading;return Object(a.jsx)("div",{className:"formauth__container",children:Object(a.jsxs)("div",{className:"formauth__page",children:[Object(a.jsxs)("header",{className:"formauth__header",children:[Object(a.jsx)("img",{className:"formauth__header-logo",src:_,alt:"\u041b\u043e\u0433\u043e"}),Object(a.jsx)(s.b,{className:"formauth__header-link",to:l,children:u})]}),Object(a.jsx)("main",{className:"formauth__main",children:Object(a.jsxs)("div",{className:"formauth__main-container",children:[Object(a.jsx)("h2",{className:"formauth__main-title",children:r}),Object(a.jsxs)("form",{className:"formauth__main-form",onSubmit:p,children:[Object(a.jsxs)("fieldset",{className:"formauth__main-form-fieldset",children:[Object(a.jsx)("input",{className:"formauth__main-form-input",id:"email",name:"email",type:"email",placeholder:"Email",required:!0,value:o.email||"",onChange:c}),Object(a.jsx)("span",{className:"formauth__main-form-input-error ".concat(n?"":"formauth__main-form-input-error_active"),id:"email-error",children:t.email}),Object(a.jsx)("input",{className:"formauth__main-form-input",id:"password",name:"password",type:"password",placeholder:"Password",minLength:"8",required:!0,value:o.password||"",onChange:c}),Object(a.jsx)("span",{className:"formauth__main-form-input-error ".concat(n?"":"formauth__main-form-input-error_active"),id:"password-error",children:t.password})]}),Object(a.jsx)("button",{className:"formauth__main-form-button ".concat(h?"formauth__main-form-button_disabled":""),type:"submit",onClick:m,disabled:h,children:!0===f?Object(a.jsx)(I,{}):i})]}),Object(a.jsx)(s.b,{className:d,to:"/sign-in",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})})]})})}),A=n(27),B=Object(A.a)({title:{marginBottom:24,textAlign:"center",fontFamily:"Inter",fontWeight:900,fontSize:24,margin:0,"@media screen and (max-width: 512px)":{fontSize:20,marginBottom:50}},checkicon:{maxHeight:120,maxWidth:120,marginTop:26,marginBottom:32,margin:"auto","@media screen and (max-width: 512px)":{marginTop:50,marginBottom:40}}}),D=function(e){var t=e.isOpen,n=e.onClose,o=e.title,i=e.titleInfoTooltips,r=e.checkIcon,s=c.a.useState(!1),u=Object(l.a)(s,2),d=u[0],p=u[1],m=B();return c.a.useEffect((function(){p(!0)}),[d]),Object(a.jsx)(k,{isOpen:t,onClose:n,isInfoTooltip:d,classes:m,title:o,checkIcon:r,titleInfoTooltips:i})},F=n.p+"static/media/check-popup-icon.a9eb6caf.svg",V=function(e){var t=e.onRegister,n=e.handleInfoTooltipClose,c=e.handleInfoTooltipOpen,i=e.isInfoTooltipOpen,r=e.isLoading,s=S(),u=s.values,l=s.errors,d=s.isValid,p=s.handleChange;return Object(a.jsxs)(o.Fragment,{children:[Object(a.jsx)(U,{title:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",linkNameAuthHeader:"\u0412\u043e\u0439\u0442\u0438",submitButton:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f",path:"/sign-in",classLink:"formauth__main-link-on-login_active",values:u,onChange:p,isValid:d,errors:l,onSubmit:function(e){e.preventDefault(),t(u).then((function(e){return e&&c()}))},disabled:!d,isLoading:r}),!0===i&&Object(a.jsx)(D,{isOpen:i,onClose:n,titleInfoTooltips:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!",checkIcon:F})]})},q=n.p+"static/media/Errorcheck-popup-icon.d4ce2a26.svg",J=Object(d.h)((function(e){var t=e.onLogin,n=e.handleInfoTooltipClose,c=e.handleInfoTooltipOpen,i=e.isInfoTooltipOpen,r=e.isLoading,s=S(),u=s.values,l=s.errors,p=s.isValid,m=s.handleChange,h=s.resetForm,f=Object(d.g)();return Object(a.jsxs)(o.Fragment,{children:[Object(a.jsx)(U,{title:"\u0412\u0445\u043e\u0434",linkNameAuthHeader:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",path:"/sign-up",classLink:"formauth__main-link-on-login_hidden",submitButton:"\u0412\u043e\u0439\u0442\u0438",values:u,onChange:m,isValid:p,errors:l,onSubmit:function(e){e.preventDefault(),t(u).then((function(){localStorage.setItem("email",u.email),f.push("/")})).catch((function(e){e&&(c(),h(),console.log({message:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0441 email: ".concat(u.email," \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d")}))}))},disabled:!p,isLoading:r}),!0===i&&Object(a.jsx)(D,{isOpen:i,onClose:n,titleInfoTooltips:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437.",checkIcon:q})]})})),H=n(29),z=function(e){var t=e.component,n=Object(H.a)(e,["component"]);return Object(a.jsx)(d.b,{children:!0===n.loggedIn?Object(a.jsx)(t,Object(y.a)({},n)):Object(a.jsx)(d.a,{to:"/sign-up"})})},M=Object(d.h)((function(){var e=c.a.useState(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],i=c.a.useState(!1),r=Object(l.a)(i,2),s=r[0],m=r[1],h=c.a.useState(!1),_=Object(l.a)(h,2),O=_[0],x=_[1],k=c.a.useState(!1),N=Object(l.a)(k,2),y=N[0],S=N[1],I=c.a.useState(!1),U=Object(l.a)(I,2),A=U[0],B=U[1],D=c.a.useState(null),F=Object(l.a)(D,2),q=F[0],H=F[1],M=c.a.useState({}),R=Object(l.a)(M,2),W=R[0],G=R[1],Y=c.a.useState([]),K=Object(l.a)(Y,2),Q=K[0],X=K[1],Z=c.a.useState({}),$=Object(l.a)(Z,2),ee=$[0],te=$[1],ne=c.a.useState(!1),ae=Object(l.a)(ne,2),oe=ae[0],ce=ae[1],ie=c.a.useState(!1),re=Object(l.a)(ie,2),se=re[0],ue=re[1],le=c.a.useState(!1),de=Object(l.a)(le,2),pe=de[0],me=de[1],he=Object(d.g)();c.a.useEffect((function(){f.getUserInfo().then((function(e){te(e)})).catch((function(e){console.log(e)}))}),[]),c.a.useEffect((function(){f.getInitialCards().then((function(e){X(e)})).catch((function(e){console.log(e)}))}),[]);var fe=function(){o(!1),m(!1),x(!1),S(!1),B(!1)};c.a.useEffect((function(){var e=function(e){"Escape"===e.key&&fe()};return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}}),[]),c.a.useEffect((function(){se&&he.push("/")}),[se]);c.a.useEffect((function(){var e=localStorage.getItem("jwt");e&&je(e)}),[]);var je=function(e){var t;(t=e,fetch("".concat(j,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(b).then((function(e){return e}))).then((function(t){if(t&&(ue(!0),he.push("/")),400===t.statusCode)throw new Error({message:"\u0422\u043e\u043a\u0435\u043d: ".concat(e," \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u0438\u043b\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u043d \u043d\u0435 \u0432 \u0442\u043e\u043c \u0444\u043e\u0440\u043c\u0430\u0442\u0435")});if(401===t.statusCode)throw new Error({message:"\u041f\u0435\u0440\u0435\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u043e\u043a\u0435\u043d: ".concat(e," \u043d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u0435\u043d")})}))},be=function(){me(!1),he.push("/sign-in")},_e=function(){me(!0)};return Object(a.jsx)(p.Provider,{value:ee,children:Object(a.jsxs)("div",{className:"page",children:[Object(a.jsx)(g,{handleSignOut:function(){localStorage.removeItem("jwt"),localStorage.removeItem("email"),he.push("/sign-in"),ue(!1)},loggedIn:se}),Object(a.jsxs)(d.d,{children:[Object(a.jsx)(d.b,{path:"/sign-up",children:Object(a.jsx)(V,{onRegister:function(e){var t=e.email,n=e.password;return ce(!0),function(e,t){return fetch("".concat(j,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(b).then((function(e){return e}))}(t,n).then((function(e){if(!e||400===e.statusCode)throw new Error({message:"\u041d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"});return e})).catch((function(){return console.log({message:"\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"})})).finally((function(){ce(!1)}))},handleInfoTooltipClose:be,handleInfoTooltipOpen:_e,isInfoTooltipOpen:pe,isLoading:oe})}),Object(a.jsx)(d.b,{path:"/sign-in",children:Object(a.jsx)(J,{onLogin:function(e){var t=e.email,n=e.password;return ce(!0),function(e,t){return fetch("".concat(j,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(b).then((function(e){return e}))}(t,n).then((function(e){if(!e||400===e.statusCode)throw new Error({message:"\u041d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u043e \u043e\u0434\u043d\u043e \u0438\u0437 \u043f\u043e\u043b\u0435\u0439"});if(e.token)return ue(!0),localStorage.setItem("jwt",e.token),e})).finally((function(){ce(!1)}))},handleInfoTooltipClose:be,handleInfoTooltipOpen:_e,isInfoTooltipOpen:pe,isLoading:oe})}),Object(a.jsx)(z,{path:"/",component:v,onEditAvatar:function(){x(!0)},onEditProfile:function(){o(!0)},onAddPlace:function(){m(!0)},onConfirmDeleteCardClick:function(e){G(e),B(!0)},onCardClick:function(e){H(e),S(!0)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===ee._id}));f.changeLikeCardStatus(e,t).then((function(t){var n=Q.map((function(n){return n._id===e._id?t:n}));X(n)})).catch((function(e){console.log(e)}))},cards:Q,loggedIn:se})]}),Object(a.jsx)(C,{loggedIn:se}),Object(a.jsx)(L,{isOpen:n,onClose:fe,onUpdateUser:function(e){ce(!0),f.setUserInfo(e).then((function(e){te(e),fe()})).catch((function(e){console.log(e)})).finally((function(){ce(!1)}))},isLoading:oe}),Object(a.jsx)(w,{isOpen:O,onClose:fe,onUpdateAvatar:function(e){ce(!0),f.setUserAvatar(e).then((function(e){te(e),fe()})).catch((function(e){console.log(e)})).finally((function(){ce(!1)}))},isLoading:oe}),Object(a.jsx)(T,{isOpen:s,onClose:fe,onAddPlace:function(e){ce(!0),f.addNewCard(e).then((function(e){X([e].concat(Object(u.a)(Q))),fe()})).catch((function(e){console.log(e)})).finally((function(){ce(!1)}))},isLoading:oe}),Object(a.jsx)(E,{isOpen:A,onClose:fe,onCardDelete:function(){ce(!0),f.deleteCard(W._id).then((function(){var e=Q.filter((function(e){return e._id!==W._id}));X(e),fe()})).catch((function(e){console.log(e)})).finally((function(){ce(!1)}))},isLoading:oe}),Object(a.jsx)(P,{selectedCard:q,onClose:fe,isOpen:y})]})})}));r.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(s.a,{children:Object(a.jsx)(M,{})})}),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.09a02217.chunk.js.map